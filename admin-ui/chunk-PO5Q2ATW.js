import{C as c,F as d,yb as l}from"./chunk-VTM3PV2E.js";var n=class extends Error{};n.prototype.name="InvalidTokenError";function g(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,o)=>{let r=o.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function u(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return g(e)}catch{return atob(e)}}function i(t,e){if(typeof t!="string")throw new n("Invalid token specified: must be a string");e||(e={});let o=e.header===!0?0:1,r=t.split(".")[o];if(typeof r!="string")throw new n(`Invalid token specified: missing part #${o+1}`);let s;try{s=u(r)}catch(a){throw new n(`Invalid token specified: invalid base64 for part #${o+1} (${a.message})`)}try{return JSON.parse(s)}catch(a){throw new n(`Invalid token specified: invalid json for part #${o+1} (${a.message})`)}}var p=class t{constructor(e){this.route=e}decodedToken;token;setToken(e,o){localStorage.setItem("Token",e),localStorage.setItem("refreshToken",o)}getToken(){let e=localStorage.getItem("Token");return this.token=e,e}getRefreshToken(){return localStorage.getItem("refershToken")}deleteToken(){localStorage.removeItem("Token"),localStorage.removeItem("refershToken"),this.route.navigate(["/login"])}setUser(e){localStorage.setItem("user",JSON.stringify(e))}getUser(){return JSON.parse(localStorage.getItem("user")||"{}")}decodeToken(){this.getToken()&&(this.decodedToken=i(this.token))}getDecodeToken(){return i(this.token)}getExpiryTime(){return this.decodeToken(),this.decodedToken?this.decodedToken.exp:null}isTokenExpired(){let e=this.getExpiryTime();return e?1e3*e-new Date().getTime()<5e3:!1}static \u0275fac=function(o){return new(o||t)(d(l))};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};var v={production:!1,url:"https://vv-api.securadev.com"};export{v as a,p as b};
